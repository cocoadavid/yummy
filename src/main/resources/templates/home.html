<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">

<head>
<title>Yummy</title>
	<link rel="stylesheet" href="https://bootswatch.com/flatly/bootstrap.min.css">
<link rel="stylesheet" type="text/css" th:href="@{/css/home.css}" />
<script	src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script	src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>

<body>
	<!-------NAVBAR------->
	<nav class="navbar navbar-default">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a id="img-home" class="navbar-brand" href="/home"><img th:src="@{/images/logo/yummy_white.png}" height="150%" alt="Yummy" /></a>
			</div>

			<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
				<ul class="nav navbar-nav">
					<li class="hover-bold"><a href="#" class="hover-bold" th:text="${username}"></a></li>
					<li class="hover-bold"><a href="/new_recipe" class="hover-bold">New Recipe</a></li>
				</ul>
				<form class="navbar-form navbar-left" role="search">
					<div class="form-group">
						<input type="text" class="form-control" placeholder="Search Users">
					</div>
					<button type="submit" class="btn btn-info"><span class="glyphicon glyphicon-search"></span></button>
				</form>
				<ul class="nav navbar-nav navbar-right">
					<li class="hover-bold"><a href="/logout"><span class="glyphicon glyphicon-log-out"></span> Log out</a></li>
				</ul>
			</div>
		</div>
	</nav>
<!-------END OF NAVBAR------->
	<div class="container-fluid">
		<!-------SUCCESS MESSAGE -->
		<div th:if="${success}" class="alert alert-success alert-dismissable" style="text-align: center">
			<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
			<strong>You have successfully created a new recipe!</strong>
		</div>
		<!-------FEED------->
		<div class="row" style="max-width: 1280px; margin-left: auto; margin-right: auto; display: table;">
			<!--Iteration-->
			<div class="col-lg-4 col-md-6" th:each="recipe, iterStat : ${recipes}" >
				<div style="width: 400px; margin-left: auto; margin-right: auto; display: table;">
					<h4 th:text="${recipe.user.username}" style="margin-left: 15px; color: #FF6666; float: left;"></h4>
				</div>
				<div style="background-color: #FF6666; height: 500px; width: 400px; border-radius: 5px;
margin-bottom: 40px; margin-left: auto; margin-right: auto; display: table; box-shadow: 5px 5px 20px #888888">
					<h3 th:text="${recipe.name}" style="color: white; font-weight: bold; margin-left: 10px; margin-top: 5px;"></h3>
					<a th:href="'/recipe/' + ${recipe.id}">
						<img th:src="'/image/' + ${recipe.id}" width="100%" alt="Yummy" />
					</a>
					<br/>
					<h4 style="color: white;"><span class="glyphicon glyphicon-heart" style="color: white"></span> Yummy!  <span class="glyphicon glyphicon-comment" style="color: white"></span> Comment</h4>
					<br/>
					<button class="btn btn-default yummy" th:id="${recipe.id}">Yummy</button><button class="btn btn-sm" th:id="'yummy' + ${recipe.id}" th:text="${recipe.yummy}"></button>
				</div>
			</div>
		</div>
	</div>
<script>
    $(document).ready(function(){
		$('button.yummy').click(function (event) {
		    var button = $(event.currentTarget);
		    var recipe_id = button.attr('id');
			$.ajax({
				url:'/yummy/' + recipe_id,
				method: 'POST',
				error: function () {
					alert('error');
                },
				success: function (data) {
					var info = JSON.parse(data);
					var yummy = info['yummy'];
					$('button#yummy' + recipe_id).text(yummy);
                }

			})
        })
	});
</script>
</body>
</html>